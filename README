/*
 * Copyright (c) 2013 CNRS/LAAS & ISIR/UPMC
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */

                   *** AUDIO_STREAM_SERVER ***  
  
  The Audio Stream Server broadcasts the audio aquire from a binaural configuration. 
  The Audio can be retrieve by any genom module or with the Genomix-Matlab Bridge.
  The length of the audio is chosen when the server is launched. The default values
  are shown below and the audio on the port will have a length of: 

        Audio Length [sec] = (chunk_time*Port_chunks)/1000 = (50*20)/1000 = 1 sec
    
  CONTENTS:  
  0. GETTING STARTED.
  1. HOW TO USE THE AUDIO_STREAM_SERVER  
  2. HOW TO USE THE CLIENT_TOY_MODULE  
  3. RECOMMENDED STEPS TO USE THE SERVER AND THE "TOY-CLIENT"  

0.GETTING STARTED -------------------------------------------------------------  
    First of all, make sure you have all these environment variables set:
    export PATH=${PATH}:${HOME}/openrobots/bin:${HOME}/openrobots/sbin
    export INSTALL_DIR=${HOME}/openrobots
    export TEMPLATES=ros/server,ros/client/c,ros/client/ros
    export PKG_CONFIG_PATH=$INSTALL_DIR/lib/pkgconfig

1.HOW TO USE THE AUDIO_STREAM_SERVER -------------------------------------------  
    1.1. Build the Server:  
      1.1.1 Open a new Terminal (T1):  
      1.1.2 Go to path /audio_stream_server/capture  
      1.1.3 > genom3 skeleton -m auto capture.gen  
      1.1.4 > ./bootstrap.sh  
      1.1.5 > mkdir build  
      1.1.6 > cd build  
      1.1.7 > ../configure --prefix=$INSTALL_DIR --with-templates=$TEMPLATES 
      1.1.8 > make  
      1.1.9 > sudo make install  
  
    1.2. Run the Server:  
      In the same Terminal (T1):  
      1.2.1 > roscore &  
      1.2.2 > capture-ros -b &  
      1.2.3 > genomixd &  
      1.2.4 > eltclsh  
      1.2.5 > package require genomix  
      1.2.6 > ::genomix::connect  
      1.2.7 > genomix1 load capture  
      1.2.8 > ::capture::StartCapture &
      1.2.9 string device: Name of the sound device (hw:1,0) > If no value is entered, default value is hw:1,0.
      1.2.10 unsigned long transfer_rate: Sample rate in Hz (44100) > If no value is entered, default value is 44100.
      1.2.11 unsigned long chunk_time: Size of transfer chunks in miliseconds (50) > If no value is entered, default value is 50.
      1.2.12 unsigned long Port_chunks: Size of the Port in number of chunks (20) > If no value is entered, default value is 20.
      1.2.13 eltclsh > ::capture::DedicatedSocket &
  
    1.3. Stop the Server  
      In the same Terminal (T1):  
      1.3.1 eltclsh > ::capture::StopCapture  
      1.3.2 eltclsh > ::capture::CloseSocket
      1.3.3 eltclsh > ::capture::kill  
      1.3.4 eltclsh > exit
      1.3.5 > pkill genomixd  
